(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1362:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(1847).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},2056:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(1847).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3464:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(1847).A)("list-filter",[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]])},5998:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(1847).A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},6983:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(1847).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},7322:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var l=t(5155),a=t(2115),r=t(3464),i=t(5870),n=t(9865),c=t(5998),d=t(2056),x=t(6983),o=t(1362),m=t(189),h=t(5643),u=t(5196),p=t(2619),g=t.n(p),j=t(7003),y=t(3209),f=t(7812);function N(){let[e,s]=(0,a.useState)(!1),[t,p]=(0,a.useState)("all"),[N,v]=(0,a.useState)("none"),[w,b]=(0,a.useState)("idle"),[k,A]=(0,a.useState)([]),[S,C]=(0,a.useState)(!0),[E,Z]=(0,a.useState)(null),{user:M}=(0,u.A)();(0,a.useEffect)(()=>{(async()=>{try{C(!0);let e=await fetch("/api/licenses");if(!e.ok)throw Error("Failed to fetch licenses");let s=await e.json();A(s),Z(null)}catch(e){console.error("Error fetching licenses:",e),Z("Failed to load license data. Please try again later.")}finally{C(!1)}})()},[]);let B=(0,a.useMemo)(()=>({total:k.length,expired:k.filter(e=>"Expired"===e.computedStatus).length,warning:k.filter(e=>"Expiring Soon"===e.computedStatus).length,active:k.filter(e=>"Active"===e.computedStatus).length}),[k]),R=(0,a.useMemo)(()=>k.filter(e=>"expired"===t?"Expired"===e.computedStatus:"warning"===t?"Expiring Soon"===e.computedStatus:"active"!==t||"Active"===e.computedStatus),[k,t]);return(0,l.jsxs)("div",{className:"min-h-screen pb-12 bg-background",children:[(0,l.jsx)("nav",{className:"bg-card shadow-sm border-b sticky top-0 z-30",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between h-16",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"bg-primary p-2 rounded-lg text-primary-foreground",children:(0,l.jsx)(r.A,{size:24})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"License Tracking System"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"ระบบติดตามใบอนุญาต"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(h.U,{}),M?(0,l.jsx)(j.$,{asChild:!0,children:(0,l.jsxs)(g(),{href:"/admin",children:[(0,l.jsx)(i.A,{className:"mr-2 h-4 w-4"}),"Admin"]})}):(0,l.jsx)(j.$,{asChild:!0,variant:"outline",children:(0,l.jsxs)(g(),{href:"/login",children:[(0,l.jsx)(n.A,{className:"mr-2 h-4 w-4"}),"เข้าสู่ระบบ"]})}),(0,l.jsxs)(j.$,{onClick:()=>{b("sending"),setTimeout(()=>{b("sent"),setTimeout(()=>b("idle"),3e3),alert("[จำลอง] ส่งแจ้งเตือนไปยัง LINE OA เรียบร้อยแล้ว!\n\nรายการแจ้งเตือน:\n- หมดอายุ: ".concat(B.expired," รายการ\n- ใกล้หมด: ").concat(B.warning," รายการ"))},1500)},disabled:"idle"!==w,className:"bg-[#00B900] hover:bg-[#009900] text-white",children:[(0,l.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"sending"===w?"Sending...":"sent"===w?"Sent!":"Notify LINE"]})]})]})})}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[(0,l.jsx)(y.Zp,{className:"border-primary/20 bg-primary/5 dark:bg-primary/5",children:(0,l.jsxs)(y.aR,{children:[(0,l.jsx)(y.ZB,{className:"text-3xl",children:"ภาพรวมใบอนุญาต"}),(0,l.jsxs)(y.BT,{className:"text-base",children:["ตรวจสอบสถานะวันหมดอายุของใบอนุญาต (Registration), แยกตามบริษัท และแจ้งเตือนอัตโนมัติ ข้อมูลอัปเดตล่าสุด: ",new Date().toLocaleDateString("th-TH")]})]})}),S&&(0,l.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}),E&&(0,l.jsx)(y.Zp,{className:"border-destructive",children:(0,l.jsxs)(y.aR,{children:[(0,l.jsx)(y.ZB,{className:"text-destructive",children:"Error"}),(0,l.jsx)(y.BT,{children:E})]})}),!S&&!E&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,l.jsxs)(y.Zp,{className:"cursor-pointer transition-all ".concat("all"===t?"ring-2 ring-primary":"hover:shadow-lg"),onClick:()=>p("all"),children:[(0,l.jsxs)(y.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(y.ZB,{className:"text-sm font-medium",children:"ใบอนุญาตทั้งหมด"}),(0,l.jsx)("div",{className:"p-3 bg-primary/10 rounded-lg",children:(0,l.jsx)(r.A,{className:"h-6 w-6 text-primary"})})]}),(0,l.jsxs)(y.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:B.total}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"รายการทั้งหมด"})]})]}),(0,l.jsxs)(y.Zp,{className:"cursor-pointer transition-all ".concat("expired"===t?"ring-2 ring-destructive":"hover:shadow-lg"),onClick:()=>p("expired"),children:[(0,l.jsxs)(y.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(y.ZB,{className:"text-sm font-medium",children:"หมดอายุแล้ว"}),(0,l.jsx)("div",{className:"p-3 bg-destructive/10 rounded-lg",children:(0,l.jsx)(d.A,{className:"h-6 w-6 text-destructive"})})]}),(0,l.jsxs)(y.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-destructive",children:B.expired}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"ต้องดำเนินการด่วน"})]})]}),(0,l.jsxs)(y.Zp,{className:"cursor-pointer transition-all ".concat("warning"===t?"ring-2 ring-yellow-500":"hover:shadow-lg"),onClick:()=>p("warning"),children:[(0,l.jsxs)(y.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(y.ZB,{className:"text-sm font-medium",children:"ใกล้หมดอายุ (90 วัน)"}),(0,l.jsx)("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900/20 rounded-lg",children:(0,l.jsx)(x.A,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-500"})})]}),(0,l.jsxs)(y.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:B.warning}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"ควรเตรียมต่ออายุ"})]})]}),(0,l.jsxs)(y.Zp,{className:"cursor-pointer transition-all ".concat("active"===t?"ring-2 ring-green-500":"hover:shadow-lg"),onClick:()=>p("active"),children:[(0,l.jsxs)(y.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(y.ZB,{className:"text-sm font-medium",children:"ใช้งานปกติ"}),(0,l.jsx)("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg",children:(0,l.jsx)(o.A,{className:"h-6 w-6 text-green-600 dark:text-green-500"})})]}),(0,l.jsxs)(y.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:B.active}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"ยังไม่ต้องดำเนินการ"})]})]})]}),(0,l.jsx)(y.Zp,{children:(0,l.jsx)(y.Wu,{className:"pt-6",children:(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[(0,l.jsx)("span",{className:"text-sm font-medium whitespace-nowrap",children:"Group By:"}),(0,l.jsxs)("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:[(0,l.jsx)(j.$,{type:"button",variant:"none"===N?"default":"outline",onClick:()=>v("none"),className:"rounded-r-none",children:"None"}),(0,l.jsx)(j.$,{type:"button",variant:"company"===N?"default":"outline",onClick:()=>v("company"),className:"rounded-none border-l-0",children:"Company"}),(0,l.jsx)(j.$,{type:"button",variant:"tag"===N?"default":"outline",onClick:()=>v("tag"),className:"rounded-l-none border-l-0",children:"Tag"})]})]}),(0,l.jsxs)(f.E,{variant:"secondary",className:"text-sm",children:["แสดงข้อมูล ",R.length," รายการ จากทั้งหมด ",k.length]})]})})}),(0,l.jsx)(m.I,{data:R,groupBy:N})]})]})]})}},7772:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(1847).A)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},9711:(e,s,t)=>{Promise.resolve().then(t.bind(t,7322))},9865:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});let l=(0,t(1847).A)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]])}},e=>{e.O(0,[241,875,188,594,441,255,358],()=>e(e.s=9711)),_N_E=e.O()}]);